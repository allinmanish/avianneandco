<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category   design_default
 * @package    Mage
 * @copyright  Copyright (c) 2008 Irubin Consulting Inc. DBA Varien (http://www.varien.com)
 * @license    http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */

/**
 * Product additional attributes template
 *
 * @see Mage_Catalog_Block_Product_View_Attributes
 */
?>
<?php
    $_helper = $this->helper('catalog/output');
    $_product = $this->getProduct()
?>
<?php if($_additional = $this->getAdditionalData()): ?>
<?php /* ?>
<div class="collateral-box attribute-specs">
<table cellspacing="10">
<tr>
<td width =60%>
<?php */ ?>    
<div class="data-table-wrapper">
<table cellspacing="0" class="data-table" id="product-attribute-specs-table">
    <?php foreach ($_additional as $_data): ?>
    <?php if ($_data['value'] != "No") { ?>
    <tr>
        <td class="label"><?php echo $this->htmlEscape($this->__($_data['label'])) ?></td>
        <td class="data" data-value="<?php echo floatval($_helper->productAttribute($_product, $_data['value'], $_data['code'])); ?>"><?php if($_data['label']=='Ring Size'): echo $this->__('%d (ReSizable)', $_data['value']); else: echo $_helper->productAttribute($_product, $_data['value'], $_data['code']); endif; ?></td>
    </tr>
    <?php } ?>
    <?php endforeach; ?>
</table>
</div>
<script type="text/javascript">decorateTable('product-attribute-specs-table')</script>
<?php /* ?>
</td>
<td>
<div align="center">
	<?php 
	$m = $this->helper('catalog/output')->productAttribute($this->getProduct(), nl2br($this->getProduct()->getDescription()), 'description');
	if (empty($m)) {
		echo '<div style="text-align:center;">
		<a class="youtube-lazy-link" href="http://www.youtube.com/watch?v=nMj4SpnFY2Y" style="width:300px;height:244px;" title="Click to play!"></a>
	</div>';
		$frame_content = '<iframe width="300" height="244" src="http://www.youtube.com/embed/nMj4SpnFY2Y?autoplay=1" frameborder="0" allowfullscreen></iframe>';
	} else {
		
		if (stripos($m, "iframe")!==false) {
			$frame_content = preg_replace("!src=\"(.*?)\"!si","src=\"\\1?autoplay=1\"",$m);
			echo '<div style="text-align:center;"><div class="youtube-lazy-link" style="width:300px;height:244px;"></div></div>';
		} elseif (stripos($m, "embed")!==false) {
			$frame_content = preg_replace("!src=\"(.*?)\"!si","src=\"\\1&autoplay=1\"",$m);
			echo '<div style="text-align:center;"><div class="youtube-lazy-link" style="width:300px;height:244px;"></div></div>';
		} else {
			echo $m;
			$frame_content = $m;
		}
	}
	//$d = '<iframe width="300" height="244" src="http://www.youtube.com/embed/nMj4SpnFY2Y?rel=0" frameborder="0" allowfullscreen></iframe>';
	?>	
</div>
</td>
</tr>
</table>
</div>
<script type="text/javascript">
jQuery(document).ready(function() {
	jQuery(".youtube-lazy-link").each(function(index) {
	    jQuery(this).html('');    	
	    jQuery(this).prepend('<div style="height:'+(parseInt(jQuery(this).css("height"))-4)+'px;width:'+(parseInt(jQuery(this).css("width"))-4)+'px;" class="youtube-lazy-link-div"></div>&nbsp;');
	    jQuery(this).css("background", "#000 url(<?php echo $this->getSkinUrl('images/youtube.jpg') ?>) center center no-repeat");
	    var videoFrame = '<?php echo $frame_content; ?>';
	    jQuery(this).click(function(e){
	    	jQuery('.youtube-lazy-link').replaceWith(videoFrame);
	    	e.preventDefault();
		});
	});
})
</script>
<?php */ ?> 
<?php endif;?>