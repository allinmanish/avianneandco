<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category   design_default
 * @package    Mage
 * @copyright  Copyright (c) 2008 Irubin Consulting Inc. DBA Varien (http://www.varien.com)
 * @license    http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */
?>
<?php
/**
 * Product list toolbar
 *
 * @see Mage_Catalog_Block_Product_List_Toolbar
 */
?>
<?php $cmsPageUrlKey = Mage::getSingleton('cms/page')->getIdentifier(); ?>
<script type="text/javascript">
	function __doPostBack(elm) {
		var val = elm.options[elm.selectedIndex].value;
		if(val.indexOf("ajax=1")>=0){
			val=val.replace("ajax=1&","");
			val=val.replace("&ajax=1","");
			val=val.replace("ajax=1","")
		}
		location.replace(val);
	}
</script>
<?php if($this->getCollection()->getSize()): ?>
    <table class="pager block-layered-nav" cellspacing="0">
        <tr>
        	<td class="filter-main-group">
            	<table>
            		<tr>
            			<?php echo $this->getChildHtml('layered_nav') ?>
            		</tr>
            	</table>
            </td> 
			<td class="narrow-by sort-by"> 
				<select onchange="__doPostBack(this)">
					<option value="<?php echo $this->getOrderUrl('rank', 'desc') ?>" <?php if(empty($_GET["dir"])): ?> selected="selected" <?php endif; ?> > <?php echo $this->__('Sort By Price') ?> </option>
					<option value="<?php echo $this->getOrderUrl('price', 'asc') ?>" <?php if($this->getCurrentDirection() == 'asc'&&!empty($_GET["dir"])): ?> selected="selected" <?php endif; ?> >Low to High</option>
					<option value="<?php echo $this->getOrderUrl('price', 'desc') ?>" <?php if($this->getCurrentDirection() == 'desc'&&!empty($_GET["dir"])): ?> selected="selected" <?php endif; ?> >High to Low</option>
				<?php if (false):?>
	<?php $this->removeOrderFromAvailableOrders('position'); ?>
					<?php foreach($this->getAvailableOrders() as $_key=>$_order): ?>
						<option value="<?php echo $this->getOrderUrl($_key, 'desc') ?>"<?php if($this->isOrderCurrent($_key)): ?> selected="selected"<?php endif; ?>>
							<?php echo $_order ?>
						</option>
					<?php endforeach; ?>
				<?php endif; ?>	
                </select>
			</td>
            <td class="narrow-by num-page">
            	<select onchange="__doPostBack(this)">
                <option value="<?php echo $this->getLimitUrl(24) ?>" <?php if(empty($_GET['limit'])): ?>selected="selected"<?php endif;?>><?php echo $this->__('Items per page') ?></option>
                <?php foreach ($this->getAvailableLimit() as  $_key=>$_limit): ?>
                    <option value="<?php echo $this->getLimitUrl($_key) ?>"<?php if($this->isLimitCurrent($_key) && !empty($_GET['limit'])): ?> selected="selected"<?php endif ?>>
                        <?php echo $_limit ?>
                    </option>
                <?php endforeach; ?>
                </select> 
            </td>
            <?php if($this->getLastPageNum()>1): ?>
            <td class="narrow-by pages">
                <?php echo $this->getPagerHtml() ?>
            </td>
            <?php endif; ?>
            <td class="filter-price-group">
            	<table>
            		<tr>
            			<?php echo $this->getChildHtml('layered_nav') ?>
            		</tr>
            	</table>
            </td> 
            <?php if($cmsPageUrlKey != 'new'): ?>
            <td class="a-right items-num">
            <?php if($this->getLastPageNum()>1): ?>
                <?php echo $this->__('%s item(s)', $this->getTotalNum()) ?>
            <?php else: ?>
                <strong><?php echo $this->__('%s Item(s)', $this->getTotalNum()) ?></strong>
            <?php endif; ?>
            </td>
            <?php endif; ?>
        </tr>
    </table>
<?php endif ?>